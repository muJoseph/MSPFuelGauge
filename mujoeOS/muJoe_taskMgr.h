/*
 * muJoe_taskMgr.h
 *
 *  Created on: Nov 18, 2017
 *      Author: joe
 */

#ifndef MUJOE_TASKMGR_H_
#define MUJOE_TASKMGR_H_

////////////////////////////////////////////////////////////////////////////////////////////////
// INCLUDE
////////////////////////////////////////////////////////////////////////////////////////////////

#include "muJoe_types.h"


////////////////////////////////////////////////////////////////////////////////////////////////
// DEFINES
////////////////////////////////////////////////////////////////////////////////////////////////

#define TASKMGR_NUM_TASKS                   3

// Converts time in (ms) to value (dec) to load into CCR0 of TA0 when TA0 is configured as follows:
// TA0 Clock Source: ACLK
// ACLK clock source: 32.768 kHz external crystal
// ACLK clock source  frequency divider: 4
// Therefore: TA0 tick frequency = 8.192 kHz
#define TIME_MS_TO_CCR0_COUNT               8.192f

////////////////////////////////////////////////////////////////////////////////////////////////
// TYPEDEFS
////////////////////////////////////////////////////////////////////////////////////////////////

typedef uint16 (*taskEvtProcesssor_t)( uint8 taskId, uint16 events );

typedef struct taskMgr_def
{
   volatile uint8           currTaskID;
   volatile uint16          eventsArrBuffered[TASKMGR_NUM_TASKS];
   volatile uint16          eventsArr[TASKMGR_NUM_TASKS];

}taskMgr_t;

////////////////////////////////////////////////////////////////////////////////////////////////
// MACROS
////////////////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////////////////
// FUNCTION PROTOS
////////////////////////////////////////////////////////////////////////////////////////////////

void taskMgr_initTasks( void );
void taskMgr_runSystem( void );
uint8 taskMgr_setEvent( uint8 taskId, uint16 events );
void taskMgr_setEventEx( uint8 taskId, uint16 events, uint32 timeEx_ms );
uint8 taskMgr_clearEvent( uint8 taskId, uint16 events );


#endif /* MUJOE_TASKMGR_H_ */
